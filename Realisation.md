# Лабораторная работа №5 
### Задание 1: Настройка Git Hook (pre-commit)

#### 1.1 Инициализация Git-репозитория

1. Откройте терминал.
2. Перейдите в директорию вашего проекта:
  
```
cd путь/к/вашему/проекту
```

3. Инициализируйте Git-репозиторий (если ещё не инициализирован):
  
```
git init
```

#### 1.2 Создание скрипта хука pre-commit

Действия:
1. Перейдите в папку с хуками Git:
  
```
cd .git/hooks
```

2. Создайте файл `pre-commit`:
  
```
touch pre-commit
```

#### 1.3 Редактирование файла pre-commit

Где выполнять: **Терминал** или любой текстовый редактор

1. Откройте файл `pre-commit` : 
     ```
     nano pre-commit
     ```
  
2. Вставьте следующий код в файл `pre-commit`:

```
#!/bin/bash

FILES=$(git diff --cached --name-only --diff-filter=ACM | grep '\.txt$')

if [ -z "$FILES" ]; then
    exit 0
fi

ERROR=0

for FILE in $FILES; do
    if [ ! -f "$FILE" ]; then
        echo "Ошибка: файл $FILE не найден."
        ERROR=1
        continue
    fi

    if [ ! -s "$FILE" ]; then
        echo "Ошибка: файл $FILE пустой."
        ERROR=1
        continue
    fi

    # Проверка наличия подписи автора (пример: строка "Author")
    if ! grep -q "Author" "$FILE"; then
        echo "Ошибка: файл $FILE не содержит 'Author'."
        ERROR=1
    fi
done

if [ $ERROR -eq 1 ]; then
    echo "Коммит отклонен: проверьте формат .txt файлов."
    exit 1
fi

exit 0
```

3. Сохраните файл и закройте редактор:
Нажмите `Ctrl + O` для сохранения, затем `Ctrl + X` для выхода.
  

#### 1.4 Сделать файл pre-commit исполняемым

1. В терминале, находясь в папке `.git/hooks`, выполните команду:

```
chmod +x pre-commit
```

#### 1.5 Проверка работы хука

1. Создайте тестовый `.txt` файл без требуемого содержания:
  
```
echo "Test file content" > test.txt
```
   
2. Добавьте файл в индекс Git:
  
```
git add test.txt
```

3. Попытайтесь закоммитить файл:
  
```
git commit -m "Проверка хука без подписи автора"
```

   Ожидаемый результат: Коммит будет отклонён с сообщением об отсутствии строки `Author`.

4. Добавьте строку `Author` в файл:
  
```
echo "Author: Test User" >> test.txt
```

5. Добавьте изменённый файл в индекс Git:
  
```
git add test.txt
```

6. Попытайтесь повторно закоммитить:
  
```
git commit -m "Проверка хука с подписью автора"
```

   Ожидаемый результат: Коммит пройдет успешно.


### Задание 2: Установка и настройка Git Flow

#### 1. Установка Git Flow

1. Установите Git Flow:
  
```
sudo apt-get update
sudo apt-get install git-flow
```

2. Проверьте успешную установку Git Flow:
  
```
git flow version
```

   Ожидаемый результат: Отобразится версия Git Flow.

#### 2. Инициализация Git Flow

1. Перейдите в корень вашего Git-репозитория (если вы ещё не там):
  
```
cd путь/к/вашему/репозиторию
```

2. Инициализируйте Git Flow:
  
```
git flow init
```

3. Следуйте инструкциям:
   - При появлении вопросов о названиях веток можно принять настройки по умолчанию, нажав `Enter`, или настроить их по своему усмотрению.


#### 3. Создание ветки функциональности

1. Запустите создание новой функциональной ветки:
  
```
git flow feature start task-management
```

   Ожидаемый результат: Создаётся новая ветка `feature/task-management`, и Git переключается на неё.

#### 4. Внесение изменений

1. Отредактируйте файл `task_manager.py`
```
nano task_manager.py
```

```   
def create_task(title, description):
    # Логика создания задачи
    print(f"Создана новая задача: {title}")
    print(f"Описание задачи: {description}")
```
2. Сохраните файл.

#### 5. Закоммитить изменения

1. Добавьте файл в индекс Git:
  
```
git add task_manager.py
```

2. Выполните коммит с сообщением:
  
```
git commit -m "Добавлен функционал управления задачами"
```

#### 6. Завершение работы над веткой функциональности

1. Завершите функциональную ветку и слейте её в `develop`:
  
```
git flow feature finish task-management
```

   - Если возникнут конфликты, Git сообщит о них. Откройте конфликтующие файлы в текстовом редакторе и разрешите их.

### Создание релиза

#### 7. Начало релиза

1. Переключитесь на ветку `develop` (если вы ещё не там):
  
```
git checkout develop
```

2. Запустите процесс создания релиза:
  
```
git flow release start v1.0.0
```

   Ожидаемый результат: Создаётся новая релизная ветка `release/v1.0.0`, и Git переключается на неё.

#### 8. Обновление версии проекта

1. Jбновите файл `version.txt`:

```
nano version.txt
```

```
v1.0.0
Author
```

2. Сохраните файл и добавьте его в индекс Git:

```
git add version.txt
```

3. Выполните коммит:

```
git commit -m "Обновлена версия для релиза v1.0.0"
```

#### 9. Завершение релиза

1. Завершите релизную ветку и слейте изменения в `main` и `develop`:
  
```
git flow release finish v1.0.0
```

#### 10. Hotfix

1. Если в процессе использования выявлена критическая ошибка, создайте hotfix (у нас конечно же ошибки никакой не возникнет, но hotfix все равно создаем):

```
git flow hotfix start hotfix-1.0.1
```

2. Внесите изменения для исправления ошибки и коммитите:

```
echo "# Исправлена критическая ошибка" > file_with_error.py
git add file_with_error.py
git commit -m "Исправлена критическая ошибка"
```

3. Завершите hotfix и объедините его с ветками "develop" и "main":

```
git flow hotfix finish hotfix-1.0.1
```

4. Завершение работы и отправка изменений на удаленный репозиторий. Отправьте изменения на удаленный репозиторий:

```
git push origin develop
git push origin main

```
